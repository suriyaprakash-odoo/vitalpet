<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <record id="action_reportcard_update" model="ir.actions.server">
    <field name="name">Update Report Cards</field>
    <field name="model_id" ref="model_res_partner"/>
    <field name="state">code</field>
    <field name="condition">True</field>
    <field name="code">records.edit_reportcard()</field>
</record>

<record id="report_card_link_value" model="ir.values">
    <field name="name">Update Report Card Value</field>
    <field name="model">res.partner</field>
    <field name="key" >action</field>
    <field name="key2">client_action_multi</field>
    <field name="value" eval="'ir.actions.server,%d'%action_reportcard_update"/>
</record>


    <record id="action_reportcard_link" model="ir.actions.server">
      <field name="name">Update Report Card Links</field>
      <field name="model_id" ref="model_promote_campaigns_reportcard"/>
      <field name="state">code</field>
      <field name="condition">True</field>
      <field name="code">records.reportcard_createlinks()</field>
  </record>

  <record id="report_card_link_value" model="ir.values">
      <field name="name">Create Report Card Links Value</field>
      <field name="model">promote.campaigns.reportcard</field>
      <field name="key" >action</field>
      <field name="key2">client_action_multi</field>
      <field name="value" eval="'ir.actions.server,%d'%action_reportcard_link"/>
  </record>

  <record id="action_reportcard_sms" model="ir.actions.server">
    <field name="name">Send Report Card via SMS</field>
    <field name="model_id" ref="model_promote_campaigns_reportcard"/>
    <field name="state">code</field>
    <field name="condition">True</field>
    <field name="code">records.reportcard_send_sms()</field>
</record>

  <record id="report_card_sms_value" model="ir.values">
      <field name="name">Send Report Card Links in SMS Value</field>
      <field name="model">promote.campaigns.reportcard</field>
      <field name="key" >action</field>
      <field name="key2">client_action_multi</field>
      <field name="value" eval="'ir.actions.server,%d'%action_reportcard_sms"/>
  </record>



  <!--Definition of an email template with an empty body that will be used in partner mailing. Used to give a
      basis for email recipients, name and to ease the definition of a further elaborated template. -->
  <record id="email_template_reportcard" model="mail.template">
      <field name="name">Report Card Mass Mail</field>
      <field name="model_id" ref="model_promote_campaigns_reportcard"/>
      <field name="auto_delete" eval="True"/>
      <field name="partner_to">${object.petowner_id != False and object.petowner_id.id}</field>
      <field name="subject">Report card of ${object.pet_id.firstname }</field>
      <field name="report_template" ref="report_card_pet_id"/>
      <field name="report_name">${(object.pet_id.name)}_report_card</field>
      <field name="body_html"><![CDATA[
                          <p><strong> Dear ${object.petowner_id.name or ''}
                                  ,</strong> </p>
                                  <p>
                                  The health of your pet is very important to us. We are taking this opportunity to provide you with a
                                  “Report Card” on your pet to help you keep your pet healthy, happy, and in-shape! Please review
                                  the information below and call us at 210.696.3211 to make an appointment.
                                  </p>
                                  <p>
                                  Here is your report card of <strong>${object.pet_id.firstname or ''}</strong>.
                                  </p>
                                  <p>You can reply to this email if you have any questions.</p>
                                  <p>Thank you,</p>
                                  ]]>
        </field>
      </record>

  <!--  Replace the default mass-mailing wizard in base with the composition wizard -->
  <act_window name="Send Report Card via Mail"
          res_model="mail.compose.message"
          src_model="promote.campaigns.reportcard"
          view_mode="form"
          multi="True"
          target="new"
          key2="client_action_multi"
          id="action_reportcard_mass_mail"
          context="{
                      'default_no_auto_thread': False,
                      'default_composition_mode': 'mass_mail',
                      'default_partner_to': '${object.petowner_id.id or \'\'}',
                      'default_use_template': True,
                      'default_template_id': ref('email_template_reportcard'),
                  }"/>

  <record id="email_template_reportcard" model="mail.template">
      <field name="ref_ir_act_window" ref="action_reportcard_mass_mail"/>
  </record>

</odoo>
